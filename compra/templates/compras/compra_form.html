{% extends 'base.html' %}
{% load static %}

{% block title %}{% if form.instance.pk %}Editar{% else %}Nueva{% endif %} Compra{% endblock %}

{% block content %}

    <div class="container mt-4">

        <h2>{% if form.instance.pk %}Editar{% else %}Nueva{% endif %} Compra</h2>

        <form method="post" enctype="multipart/form-data">

            {% csrf_token %}

            <div class="form-group">

                <label for="id_cliente">Cliente</label>
                {{ form.cliente }}

            </div>

            <div class="form-group">

                <label>Buscar Cliente:</label>
                <input type="text" id="buscar_cliente" class="form-control" placeholder="Nombre o TelÃ©fono">
                <div id="resultados_busqueda"></div>

            </div>

            <h3 class="mt-4">Productos</h3>

            {{ form.detalles.management_form }}
            
            <div id="detalles-container">

                {% for detalle_form in form.detalles %}

                    <div class="detalle-form">

                        {{ detalle_form.as_p }}

                        <button type="button" class="btn btn-danger btn-sm remove-detalle">Eliminar</button>

                    </div>

                {% endfor %}

            </div>

            <button type="button" class="btn btn-success" id="add-detalle">Agregar Producto</button>

            <button type="submit" class="btn btn-primary mt-3">Guardar</button>

            <a href="{% url 'compra:compra_list' %}" class="btn btn-secondary mt-3">Cancelar</a>

        </form>

    </div>

    {% block extra_js %}

    <script src="{% static 'js/compra_form.js' %}"></script>
    
    {% endblock %}

{% endblock %}